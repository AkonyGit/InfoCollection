(function(){var bdcTrace_request_url="https://trace.hexun.com";var page_click_collect_sendUrl=bdcTrace_request_url+"/bdcTrace/bdcTraceClick.gif?";function BdcTraceClickAddLinkClickEvent(){var objsLink=document.getElementsByTagName("a");if(window.attachEvent){for(var i=0;i<objsLink.length;i++){objsLink[i].attachEvent("onclick",function(evnet){try{var src=event.srcElement;if(!src){src=event.target}var itemid=src.id||"-";var itemname=src.innerText||src.value||"-";var itemtype=src.TagName||"A"||"-";var targeturl=src.href||"-";var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=src.getAttribute("data-channel")||"-";var blockid=src.getAttribute("data-blockid")||"-";var itemorder=src.getAttribute("data-itemorder")||"-";pageClickCollect("","",channel,"","","","","eventid",itemid,itemname,itemtype,targeturl,blockid,itemorder,"","auto",clickX,clickY)}catch(e){console.log(1)}})}}else{for(var i=0;i<objsLink.length;i++){objsLink[i].addEventListener("click",function(event){try{var itemid=this.id||"-";var itemname=this.innerText||this.value||"-";var itemtype=this.TagName||"A"||"-";var targeturl=this.href||"-";var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=this.getAttribute("data-channel")||"-";var blockid=this.getAttribute("data-blockid")||"-";var itemorder=this.getAttribute("data-itemorder")||"-";pageClickCollect("","",channel,"","","","","eventid",itemid,itemname,itemtype,targeturl,blockid,itemorder,"","auto",clickX,clickY)}catch(e){console.log(1)}})}}}BdcTraceClickAddLinkClickEvent();String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function BdcTraceClickGetMyFunction(functionName){if(functionName==null||functionName.length<=0||functionName.indexOf("{")<0){return functionName}var start=functionName.indexOf("{");var end=functionName.indexOf("}");return functionName.substring(start+1,end).trim()}function BdcTraceClickAddInputBtnEvent(){var objs=document.getElementsByTagName("input");if(window.attachEvent){for(var i=0;i<objs.length;i++){objs[i].attachEvent("onclick",function(evnet){try{if(this.type!="text"){var src=event.srcElement;if(!src){src=event.target}var itemid=src.id||"-";var itemname=src.innerText||src.value||"-";var itemtype=src.TagName||"INPUT";var targeturl=src.onclick==null?"-":(BdcTraceClickGetMyFunction(src.onclick.toString())||"-");var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=src.getAttribute("data-channel")||"-";var blockid=src.getAttribute("data-blockid")||"-";var itemorder=src.getAttribute("data-itemorder")||"-";pageClickCollect("","",channel,"","","","","eventid",itemid,itemname,itemtype,targeturl,blockid,itemorder,"","auto",clickX,clickY)}}catch(e){}})}}else{for(var i=0;i<objs.length;i++){objs[i].addEventListener("click",function(event){try{if(this.type!="text"){var itemid=this.id||"-";var itemname=this.innerText||this.value||"-";var itemtype=this.TagName||"INPUT";var targeturl=this.onclick==null?"-":(BdcTraceClickGetMyFunction(this.onclick.toString())||"-");var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=this.getAttribute("data-channel")||"-";var blockid=this.getAttribute("data-blockid")||"-";var itemorder=this.getAttribute("data-itemorder")||"-";pageClickCollect("","",channel,"","","","","eventid",itemid,itemname,itemtype,targeturl,blockid,itemorder,"","auto",clickX,clickY)}}catch(e){}})}}}BdcTraceClickAddInputBtnEvent();function BdcTraceClickAddButtonEvent(){var objs=document.getElementsByTagName("button");if(window.attachEvent){for(var i=0;i<objs.length;i++){objs[i].attachEvent("onclick",function(evnet){try{var src=event.srcElement;if(!src){src=event.target}var itemid=src.id||"-";var itemname=src.innerText||src.value||"-";var itemtype=src.TagName||"BUTTON";var targeturl=src.onclick==null?"-":(BdcTraceClickGetMyFunction(src.onclick.toString())||"-");var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=src.getAttribute("data-channel")||"-";var blockid=src.getAttribute("data-blockid")||"-";var itemorder=src.getAttribute("data-itemorder")||"-";pageClickCollect("","",channel,"","","","","eventid",itemid,itemname,itemtype,targeturl,blockid,itemorder,"","auto",clickX,clickY)}catch(e){console.log(e.message)}})}}else{for(var i=0;i<objs.length;i++){objs[i].addEventListener("click",function(event){try{var itemid=this.id||"-";var itemname=this.innerText||this.value||"-";var itemtype=this.TagName||"BUTTON";var targeturl=this.onclick==null?"-":(BdcTraceClickGetMyFunction(this.onclick.toString())||"-");var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=this.getAttribute("data-channel")||"-";var blockid=this.getAttribute("data-blockid")||"-";var itemorder=this.getAttribute("data-itemorder")||"-";pageClickCollect("","",channel,"","","","","eventid",itemid,itemname,itemtype,targeturl,blockid,itemorder,"","auto",clickX,clickY)}catch(e){}})}}}BdcTraceClickAddButtonEvent();var _bdcTrace_clickoid=0;var _bdcTrace_url=window.location.href;
var _bdcTrace_ref=document.referrer;function getCookie(c_name){if(document.cookie.length>0){var c_start=document.cookie.indexOf(c_name+"=");if(c_start!=-1){c_start=c_start+c_name.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length}return unescape(document.cookie.substring(c_start,c_end))}}return""}function pageClickCollectX(Element,Url,Ref,Sessionid,Cookieid,Hxuid,Imei,Clickoid,Collectmethod){if(Element.attachEvent){Element.attachEvent("onmousedown",function(event){try{var eventid="click";var itemid=Element.id;var itemname=Element.innerText||Element.value;var itemtype=Element.tagName;var targeturl=Targeturl||Element.href||"-";var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=Element.getAttribute("data-channel");var blockid=Element.getAttribute("data-blockid");var itemorder=Element.getAttribute("data-itemorder");pageClickCollect(Url,Ref,channel,Sessionid,Cookieid,Hxuid,Imei,eventid,itemid,itemname,itemtype,targeturl,blockid,itemorder,Clickoid,Collectmethod,clickX,clickY)}catch(e){}})}else{Element.addEventListener("mousedown",function(){try{var eventid="click";var itemid=Element.id;var itemname=Element.innerText||Element.value;var itemtype=Element.tagName;var targeturl=Targeturl||Element.href||"-";var strXY=getMousePos(event);var clickX=strXY[0];var clickY=strXY[1];var channel=Element.getAttribute("data-channel");var blockid=Element.getAttribute("data-blockid");var itemorder=Element.getAttribute("data-itemorder");pageClickCollect(Url,Ref,channel,Sessionid,Cookieid,Hxuid,Imei,eventid,itemid,itemname,itemtype,targeturl,blockid,itemorder,Clickoid,Collectmethod,clickX,clickY)}catch(e){}})}}function pageClickCollect(url,ref,channel,sessionid,cookieid,hxuid,imei,eventid,itemid,itemname,itemtype,targeturl,blockid,itemorder,clickoid,collectmethod,clickX,clickY){_bdcTrace_clickoid++;if(_bdcTrace_url!=window.location.href){_bdcTrace_url=window.location.href;_bdcTrace_ref=_bdcTrace_url}var dom=new Image(1,1);var rnd_id="_img_"+Math.random();window[rnd_id]=dom;dom.onload=dom.onerror=function(){window[rnd_id]=null};if(channel==null||channel=="null"||channel==undefined){channel="-"}if(blockid==null||blockid=="null"||blockid==undefined){blockid="-"}if(itemorder==null||itemorder=="null"||itemorder==undefined){itemorder="-"}var cookieid=cookieid||getCookie("BDCCOOKIEID")||"-";var sessionid=sessionid||getCookie("JSESSIONID")||getCookie("BDCSESSIONID")||"-";var clickoid=clickoid||_bdcTrace_clickoid;var collectmethod=collectmethod||"manual";var siteStr=getSiteCookieid();var siteArr=siteStr.split(",");var collectmethod=collectmethod||"auto";page_click_collect_sendUrl=page_click_collect_sendUrl+"&ref="+escape(ref||_bdcTrace_ref||document.referrer||"")+"&channel="+channel+"&bdcsessionid="+sessionid+"&bdccookieid="+cookieid+"&hxuid="+hxuid+"&imei="+imei+"&showflag="+"c"+"&eventid="+eventid+"&itemid="+itemid+"&itemname="+itemname+"&clickx="+clickX+"&clicky="+clickY+"&itemtype="+itemtype+"&targeturl="+escape(targeturl||"")+"&blockid="+blockid+"&itemorder="+itemorder+"&clickoid="+clickoid+"&collectmethod="+collectmethod+"&screenratio="+window.screen.height+","+window.screen.width+"&triggertime="+CurentTime()+"&sitecookidid="+siteArr[0]+"&siteuserid="+siteArr[1]+"&r="+Math.ceil(Math.random()*100000000);dom.style.display="none";dom.style.width="0px";dom.style.height="0px";dom.src=page_click_collect_sendUrl;document.body.appendChild(dom);page_click_collect_sendUrl=bdcTrace_request_url+"/bdcTrace/bdcTraceClick.gif?"}if(document.all){window.attachEvent("unload",function(event){var now=+new Date;while(new Date-now>=10){}})}else{window.addEventListener("unload",function(event){var now=+new Date;while(new Date-now>=10){}})}function getMousePos(event){var strXYlabel;var e=event||window.event,doc=document.documentElement,body=document.body;var scrollLeft=doc&&doc.scrollLeft||body&&body.scrollLeft||0;var scrollTop=doc&&doc.scrollTop||body&&body.scrollTop||0;var clientLeft=doc&&doc.clientLeft||body&&body.clientLeft||0;var clientTop=doc&&doc.clientTop||body&&body.clientTop||0;var x=e.pageX||e.clientX+(scrollLeft-clientLeft);var y=e.pageY||e.clientY+(scrollTop-clientTop);return[x,y]}function CurentTime(){var now=new Date();var year=now.getFullYear();var month=now.getMonth()+1;var day=now.getDate();var hour=now.getHours();var minu=now.getMinutes();var sec=now.getSeconds();var millsec=now.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hour<10){hour="0"+hour}if(minu<10){minu="0"+minu}if(sec<10){sec="0"+sec}var val=year+""+month+""+day+""+hour+""+minu+""+sec;return val}function getSiteCookieid(){var Site_CookieId="";var Site_userId="";var strcookie=document.cookie;var arrcookie=strcookie.split(";");if(arrcookie.length>=1){for(var i=0;i<arrcookie.length;i++){if(Site_CookieId!=""){break}var myarrcookie=arrcookie[i];var flag=myarrcookie.indexOf("JSESSIONID")<0&&myarrcookie.indexOf("BAIDUID")<0&&myarrcookie.indexOf("BDCSESSIONID")<0&&myarrcookie.indexOf("fsp_cust_id")<0;
if(flag){Site_CookieId==""&&(Site_CookieId=getKeyId(myarrcookie,"SID"));Site_CookieId==""&&(Site_CookieId=getKeyId(myarrcookie,"emstat_bc_emcount"))}}for(var i=0;i<arrcookie.length;i++){if(Site_userId!=""){break}var myarrcookie=arrcookie[i];var flag=myarrcookie.indexOf("JSESSIONID")<0&&myarrcookie.indexOf("BAIDUID")<0&&myarrcookie.indexOf("BDCSESSIONID")<0;if(myarrcookie.indexOf("userToken")==0){Site_userId=getKeyId(myarrcookie,"");break}if(flag){Site_userId==""&&(Site_userId=getKeyId(myarrcookie,"fsp_cust_id"))}}}if(Site_CookieId==null||Site_CookieId==""){Site_CookieId="-"}strjson.siteCookieId=Site_CookieId;if(Site_userId==null||Site_userId==""){Site_userId="-"}return Site_CookieId+","+Site_userId}function getKeyId(mycookie,searchIdName){var index=-2;var c_start=mycookie.indexOf(searchIdName+"=");if(c_start!=-1){c_end=mycookie.indexOf(";",c_start);if(c_end==-1){c_end=mycookie.length}var subcookie=mycookie.substring(c_start,c_end);index=subcookie.indexOf("&");if(index>=0){subcookie=subcookie.substring(0,index)}index=subcookie.indexOf("|");if(index>=0){subcookie=subcookie.substring(0,index)}index=subcookie.indexOf("%");if(index>=0){subcookie=subcookie.substring(0,index)}index=subcookie.indexOf("=");if(index>=0){subcookie=subcookie.substring(index+1,subcookie.length)}index=subcookie.indexOf(":");if(index>=0){subcookie=subcookie.substring(index+1,subcookie.length)}if(subcookie!=null||subcookie.length>0){return subcookie}}return""}})();